<div class="bg-white rounded-lg shadow-md p-6 flex flex-col h-full">
  <h3 class="text-xl font-semibold mb-4 text-gray-800">
    Répartition Sectorielle
  </h3>


  <div *ngIf="loading" class="flex-1 flex items-center justify-center">
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 !border-secondary"></div>
  </div>


  <div *ngIf="!loading && sectoralData.length > 0" class="flex flex-col flex-1">
    <div class="chart-container flex-1 min-h-0">
      <p-chart
        type="doughnut"
        [data]="sectoralChartData"
        [options]="chartOptions"
        class="w-full h-full"
      ></p-chart>
    </div>

    <div class="stats-container mt-4 flex-shrink-0">
      <div class="stats-grid">
        <div 
          class="stat-item" 
          *ngFor="let sector of sectoralData; let i = index">
          <div 
            class="stat-color" 
            [style.background-color]="sectoralChartData?.datasets[0]?.backgroundColor[i]">
          </div>
          <span class="stat-label">{{ sector.label }}</span>
          
          <!-- Mode Portfolio: afficher les euros -->
          <span class="stat-value" *ngIf="totalAmount > 0">
            {{ calculateAmount(sector.percentage) | number:'1.0-0' }} €
          </span>
          
          <!-- Mode SCPI: afficher les pourcentages -->
          <span class="stat-value" *ngIf="totalAmount === 0">
            {{ sector.percentage | number:'1.1-1' }}%
          </span>
        </div>
      </div>
    </div>
  </div>


  <div *ngIf="!loading && sectoralData.length === 0" 
       class="flex-1 flex flex-col items-center justify-center text-gray-400">
    <i class="pi pi-chart-pie text-6xl mb-4"></i>
    <p>Aucune donnée à afficher</p>
  </div>
</div>
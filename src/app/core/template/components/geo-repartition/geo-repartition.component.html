<div class="bg-white rounded-lg shadow-md p-6 flex flex-col h-full">
  <h3 class="text-xl font-semibold mb-4 text-gray-800">
    Répartition Géographique
  </h3>

  <div *ngIf="!geoMapOptions" class="flex-1 flex items-center justify-center">
    <div class="text-gray-500">Chargement de la carte...</div>
  </div>

  <div class="chart-container flex-1 min-h-0" *ngIf="geoMapOptions">
    <echarts
      [options]="geoMapOptions"
      class="w-full h-full"
      style="display: block;">
    </echarts>
  </div>

  <div class="mt-4 grid grid-cols-2 flex-shrink-0 truncate" *ngIf="countriesLegend.length > 0">
    <div 
      *ngFor="let country of countriesLegend" 
      class="flex items-center gap-2"
    >
      <div 
        class="w-3 h-3 flex-shrink-0" 
        [style.background-color]="getCountryColor(country.value)"
      ></div>
      <span class="text-sm truncate">{{ country.name }}</span>
      <span class="text-sm whitespace-nowrap" *ngIf="country.amount">
         {{ country.amount | formatField : "currency" }}
      </span>
      <span>{{ country.value | number:'1.1-2' }}% </span>
    </div>
  </div>
</div>
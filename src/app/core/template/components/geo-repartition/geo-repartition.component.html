<div class="bg-white rounded-lg shadow-md p-6 flex flex-col h-full">
  <h3 class="text-xl font-semibold mb-4 text-gray-800">
    Répartition Géographique
  </h3>

  <div *ngIf="!geoMapOptions" class="flex-1 flex items-center justify-center">
    <div class="text-gray-500">Chargement de la carte...</div>
  </div>

  <div class="chart-container flex-1 min-h-0" *ngIf="geoMapOptions">
    <echarts
      [options]="geoMapOptions"
      class="w-full h-full"
      style="display: block;">
    </echarts>
  </div>


  <div class="legend-container mt-4 flex-shrink-0" *ngIf="countriesLegend.length > 0">
    <h4 class="text-sm font-medium text-gray-700 mb-3">Détail par pays</h4>
    
    <div class="space-y-2 max-h-24 overflow-y-auto">
      <div 
        *ngFor="let country of countriesLegend" 
        class="flex items-center justify-between p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"
      >
       
        <div class="flex items-center gap-2">
          <div 
            class="w-3 h-3 rounded-full flex-shrink-0" 
            [style.background-color]="getCountryColor(country.value)"
          ></div>
          <span class="text-sm font-medium text-gray-800">{{ country.name }}</span>
        </div>
       
        <div class="flex items-center gap-3">
          <span class="text-sm font-semibold text-blue-600" *ngIf="country.amount">
            {{ country.amount | number:'1.0-2' }} €
          </span>
          <span class="text-sm text-gray-600 min-w-[50px] text-right">
            {{ country.value | number:'1.1-2' }}%
          </span>
        </div>
      </div>
    </div>


    <div 
      *ngIf="totalInvested > 0" 
      class="mt-3 pt-3 border-t border-gray-200 flex justify-between items-center"
    >
      <span class="text-sm font-semibold text-gray-800">Total investi</span>
      <span class="text-base font-bold text-blue-700">
        {{ totalInvested | number:'1.0-2' }} €
      </span>
    </div>
  </div>
</div>